<p-table
  #tableRef
  [value]="positions$()"
  class="flex-1 min-w-full max-h-full min-h-full rounded-lg shadow-sm table-fixed"
  [responsiveLayout]="'scroll'"
  size="small"
  [scrollable]="true"
  [scrollHeight]="'calc(100vh - 184px)'"
  showGridlines
  [rowTrackBy]="trackById"
>
  <ng-template pTemplate="header">
    <tr class="bg-gray-100 dark:bg-slate-800">
      <!--
      // jscpd:ignore-start
      -->
      <th class="min-w-16 max-w-16">
        <rms-symbol-filter-header
          [(symbolFilter)]="symbolFilter"
          (filterChange)="onSymbolFilterChange()"
        ></rms-symbol-filter-header>
      </th>
      <!--
      // jscpd:ignore-end
      -->
      <th class="min-w-32 max-w-32">Ex-Date</th>
      <th class="min-w-16 max-w-16">Buy</th>
      <th
        class="min-w-32 max-w-32 cursor-pointer select-none"
        (click)="onSort('buyDate')"
      >
        <rms-sortable-header
          label="Buy Date"
          [sortIcon]="sortSignals.buyDateSortIcon$()"
          [sortOrder]="sortSignals.buyDateSortOrder$()"
        />
      </th>
      <th class="min-w-32 max-w-32">Quantity</th>
      <th>Expected&nbsp;$</th>
      <th>Last&nbsp;$</th>
      <th
        class="cursor-pointer select-none"
        (click)="onSort('unrealizedGainPercent')"
      >
        <rms-sortable-header
          label="Unrlz Gain %"
          [sortIcon]="sortSignals.unrealizedGainPercentSortIcon$()"
          [sortOrder]="sortSignals.unrealizedGainPercentSortOrder$()"
        />
      </th>
      <th class="cursor-pointer select-none" (click)="onSort('unrealizedGain')">
        <rms-sortable-header
          label="Unrlz Gain$"
          [sortIcon]="sortSignals.unrealizedGainSortIcon$()"
          [sortOrder]="sortSignals.unrealizedGainSortOrder$()"
        />
      </th>
      <th>Sell</th>
      <th>Sell Date</th>
      <th>Days Held</th>
      <th>Target Gain</th>
      <th>Target Sell</th>
      <th></th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-row>
    <tr>
      <td class="min-w-16 max-w-16">{{ row.symbol }}</td>
      <td>{{ row.exDate | date : 'MM/dd/yyyy' }}</td>
      <td [pEditableColumn]="'buy'" class="w-100 overflow-hidden">
        <rms-editable-cell
          field="buy"
          [value]="row.buy"
          type="currency"
          inputClass="w-100 block"
          [minFractionDigits]="2"
          [maxFractionDigits]="4"
          [step]="0.01"
          (commit)="onEditCommit(row, 'buy')"
        />
      </td>
      <td [pEditableColumn]="'buyDate'" class="w-32 overflow-hidden">
        <rms-editable-cell
          field="buyDate"
          [value]="row.buyDate"
          type="date"
          inputClass="w-32 block"
          (commit)="onEditCommit(row, 'buyDate')"
        />
      </td>
      <td [pEditableColumn]="'quantity'" class="w-32 overflow-hidden">
        <rms-editable-cell
          field="quantity"
          [value]="row.quantity"
          type="number"
          inputClass="w-32 block"
          [step]="1"
          (commit)="onEditCommit(row, 'quantity')"
        />
      </td>
      <td>{{ row.expectedYield | currency : 'USD' : 'symbol' : '1.2-2' }}</td>
      <td>{{ row.lastPrice | currency : 'USD' : 'symbol' : '1.2-4' }}</td>
      <td>{{ row.unrealizedGainPercent | number : '1.2-2' }}%</td>
      <td>{{ row.unrealizedGain | currency : 'USD' : 'symbol' : '1.2-4' }}</td>
      <td [pEditableColumn]="'sell'" class="w-32 overflow-hidden">
        <rms-editable-cell
          field="sell"
          [value]="row.sell"
          type="number"
          inputClass="w-32 block"
          [minFractionDigits]="2"
          [maxFractionDigits]="4"
          [step]="0.01"
          (commit)="onEditCommit(row, 'sell')"
        />
      </td>
      <td [pEditableColumn]="'sellDate'" class="w-32 overflow-hidden">
        <rms-editable-cell
          field="sellDate"
          [value]="row.sellDate"
          type="date"
          inputClass="w-32 block"
          (commit)="onEditCommit(row, 'sellDate')"
        />
      </td>
      <td>{{ row.daysHeld }}</td>
      <td>{{ row.targetGain | currency : 'USD' : 'symbol' : '1.2-4' }}</td>
      <td>{{ row.targetSell | currency : 'USD' : 'symbol' : '1.2-4' }}</td>
      <td>
        <p-button icon="pi pi-trash" severity="danger" (onClick)="trash(row)" />
      </td>
    </tr>
  </ng-template>
</p-table>
