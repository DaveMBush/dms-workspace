<p-dialog
  [(visible)]="showWarning"
  [modal]="true"
  [closable]="false"
  [draggable]="false"
  [resizable]="false"
  styleClass="session-warning-dialog"
  [style]="{ width: '400px' }"
  header="Session Expiring Soon"
>
  <div class="flex flex-column gap-4 p-2">
    <!-- Warning message -->
    <div class="text-center">
      <i class="pi pi-exclamation-triangle text-orange-500 text-4xl mb-3"></i>
      <p class="text-lg font-medium mb-2">Your session will expire soon</p>
      <p class="text-sm text-600">
        You will be automatically logged out for security.
      </p>
    </div>

    <!-- Countdown display -->
    <div class="text-center bg-orange-50 border-round p-3">
      <div class="text-3xl font-bold text-orange-600 mb-2">
        {{ formattedTime }}
      </div>
      <p-progressBar
        [value]="progressValue"
        [style]="{ height: '8px' }"
        [ngClass]="{
          'progress-warning': progressValue > 30,
          'progress-danger': progressValue <= 30
        }"
      >
      </p-progressBar>
    </div>

    <!-- Session info -->
    @if (showSessionInfoValue) {
    <div class="text-xs text-500 text-center border-top-1 surface-border pt-3">
      <p>Session started: {{ sessionStartValue | date : 'short' }}</p>
      <p>Last activity: {{ lastActivityValue | date : 'short' }}</p>
    </div>
    }
  </div>

  <ng-template pTemplate="footer">
    <div class="flex justify-content-between gap-2 w-full">
      <p-button
        label="Logout Now"
        icon="pi pi-sign-out"
        severity="secondary"
        size="small"
        (onClick)="onLogoutNow()"
      >
      </p-button>

      <p-button
        label="Extend Session"
        icon="pi pi-refresh"
        severity="success"
        size="small"
        [loading]="isExtendingSessionValue"
        (onClick)="onExtendSession()"
      >
      </p-button>
    </div>
  </ng-template>
</p-dialog>

<!-- Sound notification (optional) -->
@if (enableSoundValue) {
<audio #warningSound preload="auto">
  <source src="assets/sounds/session-warning.mp3" type="audio/mpeg" />
  <source src="assets/sounds/session-warning.wav" type="audio/wav" />
</audio>
}
